<!DOCTYPE html>
<html lang="en" class="fullheight">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <style type="text/css">
    .fullheight {
        height: 100%;
    }
    </style>
    <script type="text/javascript">
    var countdown = ["③", "②", "①", ""];
    var gStrs = ["第{0}组", "第一组", "第二组", "第三组", "第四组", "第五组", "第六组", "第七组", "第八组", "第九组"];
    var qStrs = ["第{1}题", "第1题", "第2题", "第3题"];
    var headText = "学前组视频心算题 -";
    var gIndex = 1;
    var qIndex = 1;
    var gObjs = new Array(10);
    var gMixObjs = new Array(10);

    function interval(func, wait, times) {
        var interv = function(w, t) {
            return function() {
                if (typeof t === "undefined" || t-- > 0) {
                    setTimeout(interv, w);
                    try {
                        func.call(null, t);
                    } catch (e) {
                        t = 0;
                        throw e.toString();
                    }
                }
            };
        }(wait, times);

        setTimeout(interv, wait);
    };

    function flash(t) {
        $(".card-text").number(gObjs[gIndex].nums[gObjs[gIndex].nums.length - t]);
        if (t == 0) {
            $("#go").removeClass("disabled");
            $("#go").attr("disabled", false);
        }
    }

    function count(t) {
        $(".card-text").text(countdown[3 - t]);
        if (t == 0) {
            interval(flash, gObjs[gIndex].time / gObjs[gIndex].nums.length * 1000, gObjs[gIndex].nums.length);
        }
    }

    function init() {
        $(".card-header").text(headText + " " + gStrs[gIndex] + " " + qStrs[qIndex]);
        gObjs[1] = new Group1();
        gObjs[2] = new Group2();
        gObjs[3] = new Group3();
        gObjs[4] = new Group4();
        gObjs[5] = new Group5();
        gObjs[6] = new Group6();
        gObjs[7] = new Group7();
        gObjs[8] = new Group8();
        gObjs[9] = new Group9();

        gMixObjs[1] = new Group1(true);
        gMixObjs[2] = new Group2(true);
        gMixObjs[3] = new Group3(true);
        gMixObjs[4] = new Group4(true);
        gMixObjs[5] = new Group5(true);
        gMixObjs[6] = new Group6(true);
        gMixObjs[7] = new Group7(true);
        gMixObjs[8] = new Group8(true);
        gMixObjs[9] = new Group9(true);
    }

    function prevGroup() {
        if (gIndex > 0) {
            gIndex--;
            if (gIndex <= 1) {
                $("#prev").addClass("disabled");
                $("#prev").attr("disabled", true);
            }
            if (gIndex < 9) {
                $("#next").removeClass("disabled");
                $("#next").attr("disabled", false);
            }
            $(".card-header").text(headText + " " + gStrs[gIndex] + " " + qStrs[qIndex]);
        }
    }

    function nextGroup() {
        if (gIndex < 9) {
            gIndex++;
            if (gIndex > 1) {
                $("#prev").removeClass("disabled");
                $("#prev").attr("disabled", false);
            }
            if (gIndex >= 9) {
                $("#next").addClass("disabled");
                $("#next").attr("disabled", true);
            }
            init();
        }
    }

    function go() {
        gObjs[1].generate();
        $("#go").addClass("disabled");
        $("#go").attr("disabled", true);
        interval(count, 1000, 4);
    }
    </script>
</head>

<body class="fullheight" onload="init();">
    <div class="card card-inverse text-center fullheight" style="background-color: #333; border-color: #333;">
        <div class="card-header" style="font-size: 5vw">
            学前组视频心算题 - 第一组 第1题
        </div>
        <div class="card-block" style="display: flex;">
            <h1 class="card-text" style="margin: auto; font-size: 18vw; font-family: Times">123,456</h1>
        </div>
        <div class="card-footer text-muted">
            <div class="row">
                <div class="col">
                    <button id="prev" type="button" class="btn btn-outline-danger disabled" style="font-size: 5vw" onclick="prevGroup();" disabled="disabled">上一组</button>
                    <button id="go" type="button" class="btn btn-outline-success" style="font-size: 5vw" onclick="go();">出题</button>
                    <button id="next" type="button" class="btn btn-outline-danger" style="font-size: 5vw" onclick="nextGroup();">下一组</button>
                </div>
            </div>
        </div>
    </div>
    </div>
    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js " integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n " crossorigin="anonymous "></script>
    <script src="jquery.number.min.js"></script>
    <script src="string-format.js"></script>
    <script src="Group.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js " integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb " crossorigin="anonymous "></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js " integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn " crossorigin="anonymous "></script>
</body>

</html>
